package uc

import (
	"reflect"
	"strings"
)

var Transparent = NewColor(0, 0, 0, 0)

var X11 = struct {
	AliceBlue,
	AntiqueWhite,
	Aqua,
	AquaMarine,
	Azure,
	Beige,
	Bisque,
	Black,
	BlanchedAlmond,
	Blue,
	BlueViolet,
	Brown,
	BurlyWood,
	CadetBlue,
	Chartreuse,
	Chocolate,
	Coral,
	CornflowerBlue,
	Cornsilk,
	Crimson,
	Cyan,
	DarkBlue,
	DarkCyan,
	DarkGoldenrod,
	DarkGray,
	DarkGreen,
	DarkKhaki,
	DarkMagenta,
	DarkOliveGreen,
	DarkOrange,
	DarkOrchid,
	DarkRed,
	DarkSalmon,
	DarkSeaGreen,
	DarkSlateBlue,
	DarkSlateGray,
	DarkTurquoise,
	DarkViolet,
	DeepPink,
	DeepSkyBlue,
	DimGray,
	DodgerBlue,
	FireBrick,
	FloralWhite,
	ForestGreen,
	Fuchsia,
	Gainsboro,
	GhostWhite,
	Gold,
	Goldenrod,
	Gray,
	Green,
	GreenYellow,
	Honeydew,
	HotPink,
	IndianRed,
	Indigo,
	Ivory,
	Khaki,
	Lavender,
	LavenderBlush,
	LawnGreen,
	LemonChiffon,
	LightBlue,
	LightCoral,
	LightCyan,
	LightGoldenrod,
	LightGray,
	LightGreen,
	LightPink,
	LightSalmon,
	LightSeaGreen,
	LightSkyBlue,
	LightSlateGray,
	LightSteelBlue,
	LightYellow,
	Lime,
	LimeGreen,
	Linen,
	Magenta,
	Maroon,
	MediumAquamarine,
	MediumBlue,
	MediumOrchid,
	MediumPurple,
	MediumSeaGreen,
	MediumSlateBlue,
	MediumTurquoise,
	MediumVioletRed,
	MidnightBlue,
	MintCream,
	MistyRose,
	Moccasin,
	NavajoWhite,
	NavyBlue,
	OldLace,
	Olive,
	OliveDrab,
	Orange,
	OrangeRed,
	Orchid,
	PaleGoldenrod,
	PaleGreen,
	PaleTurquoise,
	PaleVioletRed,
	PapayaWhip,
	PeachPuff,
	Peru,
	Pink,
	Plum,
	PowderBlue,
	Purple,
	RebeccaPurple,
	Red,
	RosyBrown,
	RoyalBlue,
	SaddleBrown,
	Salmon,
	SandyBrown,
	SeaGreen,
	SeaShell,
	Sienna,
	Silver,
	SkyBlue,
	SlateBlue,
	SlateGray,
	Snow,
	SpringGreen,
	SteelBlue,
	Tan,
	Teal,
	Thistle,
	Tomato,
	Turquoise,
	Violet,
	Wheat,
	White,
	WhiteSmoke,
	Yellow,
	YellowGreen Color
}{
	AliceBlue:        NewColor(0.941176, 0.972549, 1, 1),
	AntiqueWhite:     NewColor(0.980392, 0.921569, 0.843137, 1),
	Aqua:             NewColor(0, 1, 1, 1),
	AquaMarine:       NewColor(0.498039, 1, 0.831373, 1),
	Azure:            NewColor(0.941176, 1, 1, 1),
	Beige:            NewColor(0.960784, 0.960784, 0.862745, 1),
	Bisque:           NewColor(1, 0.894118, 0.768627, 1),
	Black:            NewColor(0, 0, 0, 1),
	BlanchedAlmond:   NewColor(1, 0.921569, 0.803922, 1),
	Blue:             NewColor(0, 0, 1, 1),
	BlueViolet:       NewColor(0.541176, 0.168627, 0.886275, 1),
	Brown:            NewColor(0.647059, 0.164706, 0.164706, 1),
	BurlyWood:        NewColor(0.870588, 0.721569, 0.529412, 1),
	CadetBlue:        NewColor(0.372549, 0.619608, 0.627451, 1),
	Chartreuse:       NewColor(0.498039, 1, 0, 1),
	Chocolate:        NewColor(0.823529, 0.411765, 0.117647, 1),
	Coral:            NewColor(1, 0.498039, 0.313725, 1),
	CornflowerBlue:   NewColor(0.392157, 0.584314, 0.929412, 1),
	Cornsilk:         NewColor(1, 0.972549, 0.862745, 1),
	Crimson:          NewColor(0.862745, 0.0784314, 0.235294, 1),
	Cyan:             NewColor(0, 1, 1, 1),
	DarkBlue:         NewColor(0, 0, 0.545098, 1),
	DarkCyan:         NewColor(0, 0.545098, 0.545098, 1),
	DarkGoldenrod:    NewColor(0.721569, 0.52549, 0.0431373, 1),
	DarkGray:         NewColor(0.662745, 0.662745, 0.662745, 1),
	DarkGreen:        NewColor(0, 0.392157, 0, 1),
	DarkKhaki:        NewColor(0.741176, 0.717647, 0.419608, 1),
	DarkMagenta:      NewColor(0.545098, 0, 0.545098, 1),
	DarkOliveGreen:   NewColor(0.333333, 0.419608, 0.184314, 1),
	DarkOrange:       NewColor(1, 0.54902, 0, 1),
	DarkOrchid:       NewColor(0.6, 0.196078, 0.8, 1),
	DarkRed:          NewColor(0.545098, 0, 0, 1),
	DarkSalmon:       NewColor(0.913725, 0.588235, 0.478431, 1),
	DarkSeaGreen:     NewColor(0.560784, 0.737255, 0.560784, 1),
	DarkSlateBlue:    NewColor(0.282353, 0.239216, 0.545098, 1),
	DarkSlateGray:    NewColor(0.184314, 0.309804, 0.309804, 1),
	DarkTurquoise:    NewColor(0, 0.807843, 0.819608, 1),
	DarkViolet:       NewColor(0.580392, 0, 0.827451, 1),
	DeepPink:         NewColor(1, 0.0784314, 0.576471, 1),
	DeepSkyBlue:      NewColor(0, 0.74902, 1, 1),
	DimGray:          NewColor(0.411765, 0.411765, 0.411765, 1),
	DodgerBlue:       NewColor(0.117647, 0.564706, 1, 1),
	FireBrick:        NewColor(0.698039, 0.133333, 0.133333, 1),
	FloralWhite:      NewColor(1, 0.980392, 0.941176, 1),
	ForestGreen:      NewColor(0.133333, 0.545098, 0.133333, 1),
	Fuchsia:          NewColor(1, 0, 1, 1),
	Gainsboro:        NewColor(0.862745, 0.862745, 0.862745, 1),
	GhostWhite:       NewColor(0.972549, 0.972549, 1, 1),
	Gold:             NewColor(1, 0.843137, 0, 1),
	Goldenrod:        NewColor(0.854902, 0.647059, 0.12549, 1),
	Gray:             NewColor(0.745098, 0.745098, 0.745098, 1),
	Green:            NewColor(0, 1, 0, 1),
	GreenYellow:      NewColor(0.678431, 1, 0.184314, 1),
	Honeydew:         NewColor(0.941176, 1, 0.941176, 1),
	HotPink:          NewColor(1, 0.411765, 0.705882, 1),
	IndianRed:        NewColor(0.803922, 0.360784, 0.360784, 1),
	Indigo:           NewColor(0.294118, 0, 0.509804, 1),
	Ivory:            NewColor(1, 1, 0.941176, 1),
	Khaki:            NewColor(0.941176, 0.901961, 0.54902, 1),
	Lavender:         NewColor(0.901961, 0.901961, 0.980392, 1),
	LavenderBlush:    NewColor(1, 0.941176, 0.960784, 1),
	LawnGreen:        NewColor(0.486275, 0.988235, 0, 1),
	LemonChiffon:     NewColor(1, 0.980392, 0.803922, 1),
	LightBlue:        NewColor(0.678431, 0.847059, 0.901961, 1),
	LightCoral:       NewColor(0.941176, 0.501961, 0.501961, 1),
	LightCyan:        NewColor(0.878431, 1, 1, 1),
	LightGoldenrod:   NewColor(0.933333, 0.866667, 0.509804, 1),
	LightGray:        NewColor(0.827451, 0.827451, 0.827451, 1),
	LightGreen:       NewColor(0.564706, 0.933333, 0.564706, 1),
	LightPink:        NewColor(1, 0.713725, 0.756863, 1),
	LightSalmon:      NewColor(1, 0.627451, 0.478431, 1),
	LightSeaGreen:    NewColor(0.12549, 0.698039, 0.666667, 1),
	LightSkyBlue:     NewColor(0.529412, 0.807843, 0.980392, 1),
	LightSlateGray:   NewColor(0.466667, 0.533333, 0.6, 1),
	LightSteelBlue:   NewColor(0.690196, 0.768627, 0.870588, 1),
	LightYellow:      NewColor(1, 1, 0.878431, 1),
	Lime:             NewColor(0, 1, 0, 1),
	LimeGreen:        NewColor(0.196078, 0.803922, 0.196078, 1),
	Linen:            NewColor(0.980392, 0.941176, 0.901961, 1),
	Magenta:          NewColor(1, 0, 1, 1),
	Maroon:           NewColor(0.690196, 0.188235, 0.376471, 1),
	MediumAquamarine: NewColor(0.4, 0.803922, 0.666667, 1),
	MediumBlue:       NewColor(0, 0, 0.803922, 1),
	MediumOrchid:     NewColor(0.729412, 0.333333, 0.827451, 1),
	MediumPurple:     NewColor(0.576471, 0.439216, 0.858824, 1),
	MediumSeaGreen:   NewColor(0.235294, 0.701961, 0.443137, 1),
	MediumSlateBlue:  NewColor(0.482353, 0.407843, 0.933333, 1),
	MediumTurquoise:  NewColor(0.282353, 0.819608, 0.8, 1),
	MediumVioletRed:  NewColor(0.780392, 0.0823529, 0.521569, 1),
	MidnightBlue:     NewColor(0.0980392, 0.0980392, 0.439216, 1),
	MintCream:        NewColor(0.960784, 1, 0.980392, 1),
	MistyRose:        NewColor(1, 0.894118, 0.882353, 1),
	Moccasin:         NewColor(1, 0.894118, 0.709804, 1),
	NavajoWhite:      NewColor(1, 0.870588, 0.678431, 1),
	NavyBlue:         NewColor(0, 0, 0.501961, 1),
	OldLace:          NewColor(0.992157, 0.960784, 0.901961, 1),
	Olive:            NewColor(0.501961, 0.501961, 0, 1),
	OliveDrab:        NewColor(0.419608, 0.556863, 0.137255, 1),
	Orange:           NewColor(1, 0.647059, 0, 1),
	OrangeRed:        NewColor(1, 0.270588, 0, 1),
	Orchid:           NewColor(0.854902, 0.439216, 0.839216, 1),
	PaleGoldenrod:    NewColor(0.933333, 0.909804, 0.666667, 1),
	PaleGreen:        NewColor(0.596078, 0.984314, 0.596078, 1),
	PaleTurquoise:    NewColor(0.686275, 0.933333, 0.933333, 1),
	PaleVioletRed:    NewColor(0.858824, 0.439216, 0.576471, 1),
	PapayaWhip:       NewColor(1, 0.937255, 0.835294, 1),
	PeachPuff:        NewColor(1, 0.854902, 0.72549, 1),
	Peru:             NewColor(0.803922, 0.521569, 0.247059, 1),
	Pink:             NewColor(1, 0.752941, 0.796078, 1),
	Plum:             NewColor(0.866667, 0.627451, 0.866667, 1),
	PowderBlue:       NewColor(0.690196, 0.878431, 0.901961, 1),
	Purple:           NewColor(0.627451, 0.12549, 0.941176, 1),
	RebeccaPurple:    NewColor(0.4, 0.2, 0.6, 1),
	Red:              NewColor(1, 0, 0, 1),
	RosyBrown:        NewColor(0.737255, 0.560784, 0.560784, 1),
	RoyalBlue:        NewColor(0.254902, 0.411765, 0.882353, 1),
	SaddleBrown:      NewColor(0.545098, 0.270588, 0.0745098, 1),
	Salmon:           NewColor(0.980392, 0.501961, 0.447059, 1),
	SandyBrown:       NewColor(0.956863, 0.643137, 0.376471, 1),
	SeaGreen:         NewColor(0.180392, 0.545098, 0.341176, 1),
	SeaShell:         NewColor(1, 0.960784, 0.933333, 1),
	Sienna:           NewColor(0.627451, 0.321569, 0.176471, 1),
	Silver:           NewColor(0.752941, 0.752941, 0.752941, 1),
	SkyBlue:          NewColor(0.529412, 0.807843, 0.921569, 1),
	SlateBlue:        NewColor(0.415686, 0.352941, 0.803922, 1),
	SlateGray:        NewColor(0.439216, 0.501961, 0.564706, 1),
	Snow:             NewColor(1, 0.980392, 0.980392, 1),
	SpringGreen:      NewColor(0, 1, 0.498039, 1),
	SteelBlue:        NewColor(0.27451, 0.509804, 0.705882, 1),
	Tan:              NewColor(0.823529, 0.705882, 0.54902, 1),
	Teal:             NewColor(0, 0.501961, 0.501961, 1),
	Thistle:          NewColor(0.847059, 0.74902, 0.847059, 1),
	Tomato:           NewColor(1, 0.388235, 0.278431, 1),
	Turquoise:        NewColor(0.25098, 0.878431, 0.815686, 1),
	Violet:           NewColor(0.933333, 0.509804, 0.933333, 1),
	Wheat:            NewColor(0.960784, 0.870588, 0.701961, 1),
	White:            NewColor(1, 1, 1, 1),
	WhiteSmoke:       NewColor(0.960784, 0.960784, 0.960784, 1),
	Yellow:           NewColor(1, 1, 0, 1),
	YellowGreen:      NewColor(0.603922, 0.803922, 0.196078, 1),
}

var W3C = X11

func init() {
	W3C.Gray = NewColor(0.501961, 0.501961, 0.501961, 1)
	W3C.Green = NewColor(0, 0.501961, 0, 1)
	W3C.Maroon = NewColor(0.501961, 0, 0, 1)
	W3C.Purple = NewColor(0.501961, 0, 0.501961, 1)
}

// String creates a Color from the given string, which can be either an HTML color code or a named color
// (case-insensitive). Returns fallback if the color cannot be inferred from the string.
func String(s string, fallback Color) Color {
	if ValidHTML(s) {
		return HTML(s)
	}
	s = strings.Replace(s, " ", "", -1)
	s = strings.Replace(s, "-", "", -1)
	s = strings.Replace(s, "_", "", -1)
	s = strings.Replace(s, "'", "", -1)
	s = strings.Replace(s, ".", "", -1)
	s = strings.ToUpper(s)
	if s == "TRANSPARENT" {
		return Transparent
	}
	rvalue := reflect.ValueOf(X11)
	if strings.HasPrefix(s, "WEB") {
		rvalue = reflect.ValueOf(W3C)
		s = s[3:]
	}
	rtype := rvalue.Type()
	for i := 0; i < rtype.NumField(); i++ {
		if strings.ToUpper(rtype.Field(i).Name) == s {
			return rvalue.Field(i).Interface().(Color)
		}
	}
	return fallback
}
